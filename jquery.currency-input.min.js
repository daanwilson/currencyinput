$(function(){$.fn.currencyInputs=function(t){t=$.extend({decimals:2,dec_point:",",thousands_sep:"."},t);$.fn.currencyInput=function(t){var e=$(this),a=$(this).clone();function n(){var n=e.val(),s=n<0?"-":"",i=String(parseInt(n=Math.abs(Number(n)||0).toFixed(t.decimals))),c=(c=i.length)>3?c%3:0,l=s+(c?i.substr(0,c)+t.thousands_sep:"")+i.substr(c).replace(/(\d{3})(?=\d)/g,"$1"+t.thousands_sep)+(t.decimals?t.dec_point+Math.abs(n-i).toFixed(t.decimals).slice(2):"");a.val(l),a.data("value",l)}e.before(a),e.prop("type","hidden"),n(),a.keyup(function(s){a.val()!=a.data("value")&&(function(e){var n=0,s=a.val(),i=s.lastIndexOf(t.dec_point),c=a[0].selectionStart;i<0&&(s.length>t.decimals?(i=s.length-t.decimals,c--):i=0);s.length>0&&(c>=++i?(a.data("pos-count","left"),n=c):(a.data("pos-count","right"),n=s.length-c,","!==e&&"."!=e||n--));a.data("pos",n)}(s.key),function(){var n=a.val();(n=n.split(t.thousands_sep).join("")).lastIndexOf(t.dec_point)>0?n=n.replace(t.dec_point,"."):n.length>=t.decimals&&(n=n.substr(0,n.length-t.decimals)+"."+n.substr(-t.decimals));n=parseFloat(n),n=isNaN(n)?0:parseFloat(n.toFixed(t.decimals));e.val(n)}(),n(),function(){var t=a.data("pos"),e=a.val().length;"right"==a.data("pos-count")&&(t=e-t);a[0].setSelectionRange(t,t)}())})},$(this).each(function(){$(this).currencyInput(t)})}});
